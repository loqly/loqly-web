(function(l,i){typeof exports=="object"&&typeof module<"u"?module.exports=i():typeof define=="function"&&define.amd?define(i):(l=typeof globalThis<"u"?globalThis:l||self,l.Loqly=i())})(this,(function(){"use strict";const l=async(r,t={})=>{if(!r)throw new Error("API key is required");let e=t;try{const s=window.location.href.includes("http://localhost")?"http://localhost:3000":"https://api.loqly.dev",a=await fetch(`${s}/v1/strings`,{method:"GET",headers:{Authorization:`Apikey ${r}`,"Content-Type":"application/json"}}),n=await a.json();if(!a.ok||n.error)throw new Error(n.error||"Something went wrong, please try again.");n.strings&&(e=n.strings)}catch(s){throw new Error(s)}finally{return e}};function i(r,t){if(!t)return r;const e=/\{([^\s{}]+)\}/g;return[...r.matchAll(e)].map(a=>a[1]).reduce((a,n)=>n in t?a.replace(new RegExp(`\\{${n}\\}`,"g"),t[n]):a,r)}class h{constructor({apiKey:t,defaultLocale:e="en"}){this.apiKey=t,this._defaultLocale=e,this._locale=e,this._translations=null,this._translatableElements=[]}async init(){this._translations=await l(this.apiKey),this.cacheElements(),this.translateElements(this._translatableElements)}static async getTranslations(t){return await l(t)}static interpolateTranslation(t,e=null){return i(t,e)}t(t,e=null){var a,n,o,c;const s=((n=(a=this._translations)==null?void 0:a[t])==null?void 0:n[this._locale])||((c=(o=this._translations)==null?void 0:o[t])==null?void 0:c[this._defaultLocale]);return s?i(s,e):t}cacheElements(){this._translatableElements=Array.from(document.querySelectorAll("[data-t]"))}translateElements(t){t.forEach(e=>{const s=e.getAttribute("data-t");s&&(e.textContent=this.t(s))})}translatePage(){this._translatableElements.length||this.cacheElements(),this.translateElements(this._translatableElements)}updateLanguage(t){this._locale=t,this.translatePage()}get translations(){return this._translations}set translations(t){this._translations=t}get locale(){return this._locale}set locale(t){this.locale=t}get defaultLocale(){return this._defaultLocale}set defaultLocale(t){this._defaultLocale=t}}return h}));
