(function(o,l){typeof exports=="object"&&typeof module<"u"?module.exports=l():typeof define=="function"&&define.amd?define(l):(o=typeof globalThis<"u"?globalThis:o||self,o.Loqly=l())})(this,(function(){"use strict";const o=async(r,t=null,e={})=>{if(!r)throw new Error("API key is required");let n="";Object.keys(t).length>0&&(t.projectIds&&(n+=`projectIds=${t.projectIds.join(",")}&`),t.namespaces&&(n+=`namespaces=${t.namespaces.join(",")}&`),t.languages&&(n+=`languages=${t.languages.join(",")}`));let s=e;try{const a=window.location.href.includes("http://localhost")?"http://localhost:3000":"https://api.loqly.dev",c=await fetch(`${a}/v1/strings?${n}`,{method:"GET",headers:{Authorization:`Apikey ${r}`,"Content-Type":"application/json"}}),i=await c.json();if(!c.ok||i.error)throw new Error(i.error||"Something went wrong, please try again.");i.strings&&(s=i.strings)}catch(a){throw new Error(a)}finally{return s}};function l(r,t){if(!t)return r;const e=/\{([^\s{}]+)\}/g;return[...r.matchAll(e)].map(s=>s[1]).reduce((s,a)=>a in t?s.replace(new RegExp(`\\{${a}\\}`,"g"),t[a]):s,r)}class h{constructor({apiKey:t,defaultLocale:e="en"}){this.apiKey=t,this.this._defaultLocale=e,this._locale=e,this._translations=null,this._translatableElements=[]}async init(){this._translations=await o(this.apiKey),this.cacheElements(),this.translateElements(this._translatableElements)}static async getTranslations(t,e=null,n={}){return await o(t,e,n)}static interpolateTranslation(t,e=null){return l(t,e)}t(t,e=null){var s,a,c,i;const n=((a=(s=this._translations)==null?void 0:s[t])==null?void 0:a[this._locale])||((i=(c=this._translations)==null?void 0:c[t])==null?void 0:i[this._defaultLocale]);return l(n||t,e)}cacheElements(){this._translatableElements=Array.from(document.querySelectorAll("[data-t]"))}translateElements(t){t.forEach(e=>{const n=e.getAttribute("data-t");n&&(e.textContent=this.t(n))})}translatePage(){this._translatableElements.length||this.cacheElements(),this.translateElements(this._translatableElements)}updateLanguage(t){this._locale=t,this.translatePage()}get translations(){return this._translations}set translations(t){this._translations=t}get locale(){return this._locale}set locale(t){this._locale=t}get defaultLocale(){return this._defaultLocale}set defaultLocale(t){this._defaultLocale=t}}return h}));
